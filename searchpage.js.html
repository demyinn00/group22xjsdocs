<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: searchpage.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: searchpage.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Handles the search page.
 *  Different from search.js because search.js handles search across all html pages that use the search function.
 */

import { search } from './search.js';

window.addEventListener('DOMContentLoaded', init);

/**
 * This function initializes the search page
 * and automatically extracts data from the query string and runs a search
 * @param {none}
 * @returns {none}
 */
function init() {
	const searchKeyword = document.querySelector('.search-word');
	const recipeSection = document.querySelector('.recipe-section');

	/**
	 * This function parses the query string to retrieve relevant information
	 * @param {none}
	 * @returns {string} the user's search term
	 */
	function parseQueryString() {
		let queryString = window.location.search;

		// Get rid of '?search='
		let searchTerm = queryString.substring(8);

		// Convert string back to original formatting, with disallowed characters gone
		searchTerm = searchTerm.replaceAll('+', ' ').replaceAll('-', '');
		return searchTerm;
	}

	/**
	 * This function clears the results on the search page
	 * @param {none}
	 * @return {none}
	 */
	function clearResults() {
		while (recipeSection.firstChild) {
			recipeSection.removeChild(recipeSection.firstChild);
		}
	}

	/**
	 * Shows the search results on the page
	 * @param {Object} results The search results
	 * @returns {none}
	 */
	function showResults(results) {
		console.log(results);

		// Clear the results before searching
		clearResults();

		// Add the recipes to the page
		searchKeyword.innerHTML = '"' + inputList['query'] + '"';
		for (const recipe in results) {
			const recipeCard = document.createElement('recipe-card-component');
			recipeCard.recipe = results[recipe];
			recipeSection.appendChild(recipeCard);
		}
	}

	// Automatically parse the query string and run a search on page load
	let searchTerm = parseQueryString();
	let inputList = [];

	console.log(searchTerm);

	// Send a query to spoonacular
	inputList['query'] = searchTerm;
	inputList['number'] = 10;
	inputList['offset'] = 0;
	inputList['recipe-nutrition'] = 'true';
	search(inputList).then(showResults);
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#clearObject">clearObject</a></li><li><a href="global.html#clearResults">clearResults</a></li><li><a href="global.html#formatTime">formatTime</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#initLocalStorageDoubt">initLocalStorageDoubt</a></li><li><a href="global.html#lookup">lookup</a></li><li><a href="global.html#search">search</a></li><li><a href="global.html#showResults">showResults</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Sat Nov 20 2021 03:57:51 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
